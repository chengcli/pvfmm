<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PVFMM-v1.3.0: include/pvfmm.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PVFMM-v1.3.0
   </div>
   <div id="projectbrief">Parallel Volume Fast Multipole Method</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pvfmm.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file contains the declaration of wrapper functions for PVFMM.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;<a class="el" href="pvfmm__common_8hpp_source.html">pvfmm_common.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="fmm__node_8hpp_source.html">fmm_node.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="cheb__node_8hpp_source.html">cheb_node.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="fmm__cheb_8hpp_source.html">fmm_cheb.hpp</a>&gt;</code><br />
<code>#include &lt;pvfmm.txx&gt;</code><br />
</div>
<p><a href="pvfmm_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3e6d9428bad9abe069a2afd08c0d8b1c"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a3e6d9428bad9abe069a2afd08c0d8b1c"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a3e6d9428bad9abe069a2afd08c0d8b1c">pvfmm::ChebFMM_Node</a> = <a class="el" href="classpvfmm_1_1FMM__Node.html">FMM_Node</a>&lt; <a class="el" href="classpvfmm_1_1Cheb__Node.html">Cheb_Node</a>&lt; Real &gt; &gt;</td></tr>
<tr class="memdesc:a3e6d9428bad9abe069a2afd08c0d8b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Octree node class for volume FMM.  <br /></td></tr>
<tr class="separator:a3e6d9428bad9abe069a2afd08c0d8b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1edc6ae76240fe13f4875a4174c0a9fe"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a1edc6ae76240fe13f4875a4174c0a9fe"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a1edc6ae76240fe13f4875a4174c0a9fe">pvfmm::ChebFMM</a> = <a class="el" href="classpvfmm_1_1FMM__Cheb.html">FMM_Cheb</a>&lt; <a class="el" href="pvfmm_8hpp.html#a3e6d9428bad9abe069a2afd08c0d8b1c">ChebFMM_Node</a>&lt; Real &gt; &gt;</td></tr>
<tr class="memdesc:a1edc6ae76240fe13f4875a4174c0a9fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages all the translation operators for volume FMM.  <br /></td></tr>
<tr class="separator:a1edc6ae76240fe13f4875a4174c0a9fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f207fd0e8c1f789a6fcae459f702e7"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:af9f207fd0e8c1f789a6fcae459f702e7"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">pvfmm::ChebFMM_Tree</a> = <a class="el" href="classpvfmm_1_1FMM__Tree.html">FMM_Tree</a>&lt; <a class="el" href="pvfmm_8hpp.html#a1edc6ae76240fe13f4875a4174c0a9fe">ChebFMM</a>&lt; Real &gt; &gt;</td></tr>
<tr class="memdesc:af9f207fd0e8c1f789a6fcae459f702e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The octree class for volume FMM.  <br /></td></tr>
<tr class="separator:af9f207fd0e8c1f789a6fcae459f702e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27b24a0eff6e33e7e9e8ddca8b830150"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a27b24a0eff6e33e7e9e8ddca8b830150"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a27b24a0eff6e33e7e9e8ddca8b830150">pvfmm::ChebFn</a> = typename <a class="el" href="pvfmm_8hpp.html#a3e6d9428bad9abe069a2afd08c0d8b1c">ChebFMM_Node</a>&lt; Real &gt;::Function_t</td></tr>
<tr class="memdesc:a27b24a0eff6e33e7e9e8ddca8b830150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluator function class for input volume density.  <br /></td></tr>
<tr class="separator:a27b24a0eff6e33e7e9e8ddca8b830150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aabfd50558650e071450a3d1ccd87de"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a4aabfd50558650e071450a3d1ccd87de"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a4aabfd50558650e071450a3d1ccd87de">pvfmm::PtFMM</a> = <a class="el" href="classpvfmm_1_1FMM__Pts.html">FMM_Pts</a>&lt; <a class="el" href="classpvfmm_1_1FMM__Node.html">FMM_Node</a>&lt; <a class="el" href="classpvfmm_1_1MPI__Node.html">MPI_Node</a>&lt; Real &gt; &gt; &gt;</td></tr>
<tr class="memdesc:a4aabfd50558650e071450a3d1ccd87de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages all the precomputed matrices and implements all the translation operations in FMM. An instance of PtFMM must be created and initialized with the kernel function to be used.  <br /></td></tr>
<tr class="separator:a4aabfd50558650e071450a3d1ccd87de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab401e169be7784a6397fb0b09fa494f9"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:ab401e169be7784a6397fb0b09fa494f9"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">pvfmm::PtFMM_Tree</a> = <a class="el" href="classpvfmm_1_1FMM__Tree.html">FMM_Tree</a>&lt; <a class="el" href="pvfmm_8hpp.html#a4aabfd50558650e071450a3d1ccd87de">PtFMM</a>&lt; Real &gt; &gt;</td></tr>
<tr class="memdesc:ab401e169be7784a6397fb0b09fa494f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The FMM tree data structure.  <br /></td></tr>
<tr class="separator:ab401e169be7784a6397fb0b09fa494f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbab72b4909cbdef8c630c7a184a250"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a7cbab72b4909cbdef8c630c7a184a250"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a7cbab72b4909cbdef8c630c7a184a250">pvfmm::PtFMM_Node</a> = <a class="el" href="classpvfmm_1_1FMM__Node.html">FMM_Node</a>&lt; <a class="el" href="classpvfmm_1_1MPI__Node.html">MPI_Node</a>&lt; Real &gt; &gt;</td></tr>
<tr class="memdesc:a7cbab72b4909cbdef8c630c7a184a250"><td class="mdescLeft">&#160;</td><td class="mdescRight">The node data structure used in the tree.  <br /></td></tr>
<tr class="separator:a7cbab72b4909cbdef8c630c7a184a250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8999f6dc6e918bd4719de68bb6c854"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a0b8999f6dc6e918bd4719de68bb6c854"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a0b8999f6dc6e918bd4719de68bb6c854">pvfmm::PtFMM_Data</a> = typename <a class="el" href="pvfmm_8hpp.html#a7cbab72b4909cbdef8c630c7a184a250">PtFMM_Node</a>&lt; Real &gt;::NodeData</td></tr>
<tr class="memdesc:a0b8999f6dc6e918bd4719de68bb6c854"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data used to initialize the tree.  <br /></td></tr>
<tr class="separator:a0b8999f6dc6e918bd4719de68bb6c854"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9656032395eb05b25f714ff5faf95ff0"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a9656032395eb05b25f714ff5faf95ff0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a9656032395eb05b25f714ff5faf95ff0">pvfmm::ChebFMM_CreateTree</a> (int cheb_deg, int data_dim, <a class="el" href="pvfmm_8hpp.html#a27b24a0eff6e33e7e9e8ddca8b830150">ChebFn</a>&lt; Real &gt; fn_ptr, const std::vector&lt; Real &gt; &amp;trg_coord, MPI_Comm comm, Real tol=1e-6, int max_pts=100, BoundaryType bndry=FreeSpace, int init_depth=0)</td></tr>
<tr class="memdesc:a9656032395eb05b25f714ff5faf95ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a piecewise Chebyshev volume discretization in [0,1]^3. It first constructs a uniform tree of depth init_depth and then adaptively refines each leaf node until the tails of the Chebyshev coefficients in each leaf node are smaller than tol and the number of target points in each leaf node are less than max_pts. It further refines the tree to satisfy the 2:1 balance constraint.  <br /></td></tr>
<tr class="separator:a9656032395eb05b25f714ff5faf95ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53014d99322385f17ada88d447f1b46"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:ac53014d99322385f17ada88d447f1b46"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#ac53014d99322385f17ada88d447f1b46">pvfmm::ChebFMM_CreateTree</a> (int cheb_deg, const std::vector&lt; Real &gt; &amp;leaf_coord, const std::vector&lt; Real &gt; &amp;fn_coeff, const std::vector&lt; Real &gt; &amp;trg_coord, MPI_Comm comm, BoundaryType bndry)</td></tr>
<tr class="memdesc:ac53014d99322385f17ada88d447f1b46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a piecewise Chebyshev volume discretization in [0,1]^3. It first constructs a tree with the given leaf node coordinates and then adds the Chebyshev coefficient to each leaf node.  <br /></td></tr>
<tr class="separator:ac53014d99322385f17ada88d447f1b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a548c5e1908ecf244b3917c260709d623"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a548c5e1908ecf244b3917c260709d623"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a548c5e1908ecf244b3917c260709d623">pvfmm::ChebFMM_Evaluate</a> (std::vector&lt; Real &gt; &amp;trg_value, <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *tree, size_t loc_size=0)</td></tr>
<tr class="memdesc:a548c5e1908ecf244b3917c260709d623"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run volume FMM and evaluate the result at the target points.  <br /></td></tr>
<tr class="separator:a548c5e1908ecf244b3917c260709d623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f3a3b47acd31665c82f784e56b0fa6"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:af0f3a3b47acd31665c82f784e56b0fa6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#af0f3a3b47acd31665c82f784e56b0fa6">pvfmm::ChebFMM_GetPotentialCoeff</a> (std::vector&lt; Real &gt; &amp;coeff, const <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *tree)</td></tr>
<tr class="memdesc:af0f3a3b47acd31665c82f784e56b0fa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Chebyshev coefficients for the potential.  <br /></td></tr>
<tr class="separator:af0f3a3b47acd31665c82f784e56b0fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4cb2747769199fbb4eaab430deb72e"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a2f4cb2747769199fbb4eaab430deb72e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a2f4cb2747769199fbb4eaab430deb72e">pvfmm::ChebFMM_GetLeafCoord</a> (std::vector&lt; Real &gt; &amp;leaf_coord, const <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *tree)</td></tr>
<tr class="memdesc:a2f4cb2747769199fbb4eaab430deb72e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the leaf node coordinates.  <br /></td></tr>
<tr class="separator:a2f4cb2747769199fbb4eaab430deb72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ee8fed824f0881ab2069d40cd3229b"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a33ee8fed824f0881ab2069d40cd3229b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a33ee8fed824f0881ab2069d40cd3229b">pvfmm::ChebFMM_Coeff2Nodes</a> (std::vector&lt; Real &gt; &amp;node_val, int ChebDeg, int dof, const std::vector&lt; Real &gt; &amp;coeff)</td></tr>
<tr class="memdesc:a33ee8fed824f0881ab2069d40cd3229b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate Chebyshev coefficients at tensor product Chebyshev nodes of first kind.  <br /></td></tr>
<tr class="separator:a33ee8fed824f0881ab2069d40cd3229b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7f5c08f79057bc4c94f66d72f879d7"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:aae7f5c08f79057bc4c94f66d72f879d7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#aae7f5c08f79057bc4c94f66d72f879d7">pvfmm::ChebFMM_Nodes2Coeff</a> (std::vector&lt; Real &gt; &amp;coeff, int ChebDeg, int dof, const std::vector&lt; Real &gt; &amp;node_val)</td></tr>
<tr class="memdesc:aae7f5c08f79057bc4c94f66d72f879d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert function values on tensor product Chebyshev nodes (first kind nodes) to coefficients.  <br /></td></tr>
<tr class="separator:aae7f5c08f79057bc4c94f66d72f879d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48e77bdf4fdc7bea5f728540a956b79"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:af48e77bdf4fdc7bea5f728540a956b79"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">PtFMM_Tree</a>&lt; Real &gt; *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#af48e77bdf4fdc7bea5f728540a956b79">pvfmm::PtFMM_CreateTree</a> (const std::vector&lt; Real &gt; &amp;sl_coord, const std::vector&lt; Real &gt; &amp;sl_density, const std::vector&lt; Real &gt; &amp;dl_coord, const std::vector&lt; Real &gt; &amp;dl_density, const std::vector&lt; Real &gt; &amp;trg_coord, MPI_Comm comm, int max_pts=100, BoundaryType bndry=FreeSpace, int init_depth=0)</td></tr>
<tr class="memdesc:af48e77bdf4fdc7bea5f728540a956b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new instance of the tree and return a pointer. The tree must eventually be be destroyed by calling delete.  <br /></td></tr>
<tr class="separator:af48e77bdf4fdc7bea5f728540a956b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb8771a98533183cc4ba30a9fd71c0d"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:a5eb8771a98533183cc4ba30a9fd71c0d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">PtFMM_Tree</a>&lt; Real &gt; *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#a5eb8771a98533183cc4ba30a9fd71c0d">pvfmm::PtFMM_CreateTree</a> (const std::vector&lt; Real &gt; &amp;sl_coord, const std::vector&lt; Real &gt; &amp;sl_density, const std::vector&lt; Real &gt; &amp;trg_coord, MPI_Comm comm, int max_pts=100, BoundaryType bndry=FreeSpace, int init_depth=0)</td></tr>
<tr class="memdesc:a5eb8771a98533183cc4ba30a9fd71c0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new instance of the tree and return a pointer. The tree must eventually be be destroyed by calling delete.  <br /></td></tr>
<tr class="separator:a5eb8771a98533183cc4ba30a9fd71c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1465ed63d3cc53525a2171c81b76d2a"><td class="memTemplParams" colspan="2">template&lt;class Real &gt; </td></tr>
<tr class="memitem:aa1465ed63d3cc53525a2171c81b76d2a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pvfmm_8hpp.html#aa1465ed63d3cc53525a2171c81b76d2a">pvfmm::PtFMM_Evaluate</a> (const <a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">PtFMM_Tree</a>&lt; Real &gt; *tree, std::vector&lt; Real &gt; &amp;trg_val, size_t loc_size=0, const std::vector&lt; Real &gt; *sl_density=NULL, const std::vector&lt; Real &gt; *dl_density=NULL)</td></tr>
<tr class="memdesc:aa1465ed63d3cc53525a2171c81b76d2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run FMM on the input octree and return the potential at the target points. The setup function PtFMM_Tree::SetupFMM(PtFMM_Tree* fmm_mat) must be called before evaluating FMM for the first time with a tree, or if a tree has changed.  <br /></td></tr>
<tr class="separator:aa1465ed63d3cc53525a2171c81b76d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the declaration of wrapper functions for PVFMM. </p>
<dl class="section author"><dt>Author</dt><dd>Dhairya Malhotra, <a href="#" onclick="location.href='mai'+'lto:'+'dha'+'ir'+'ya.'+'ma'+'lho'+'tr'+'a@g'+'ma'+'il.'+'co'+'m'; return false;">dhair<span class="obfuscator">.nosp@m.</span>ya.m<span class="obfuscator">.nosp@m.</span>alhot<span class="obfuscator">.nosp@m.</span>ra@g<span class="obfuscator">.nosp@m.</span>mail.<span class="obfuscator">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1-2-2014 </dd></dl>

<p class="definition">Definition in file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a1edc6ae76240fe13f4875a4174c0a9fe" name="a1edc6ae76240fe13f4875a4174c0a9fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1edc6ae76240fe13f4875a4174c0a9fe">&#9670;&#160;</a></span>ChebFMM</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a1edc6ae76240fe13f4875a4174c0a9fe">pvfmm::ChebFMM</a> = typedef FMM_Cheb&lt;ChebFMM_Node&lt;Real&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manages all the translation operators for volume FMM. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Cheb.html">pvfmm::FMM_Cheb</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00033">33</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="a3e6d9428bad9abe069a2afd08c0d8b1c" name="a3e6d9428bad9abe069a2afd08c0d8b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e6d9428bad9abe069a2afd08c0d8b1c">&#9670;&#160;</a></span>ChebFMM_Node</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a3e6d9428bad9abe069a2afd08c0d8b1c">pvfmm::ChebFMM_Node</a> = typedef FMM_Node&lt;Cheb_Node&lt;Real&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Octree node class for volume FMM. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Node.html" title="Base class for node of FMM_Node.">pvfmm::FMM_Node</a>, <a class="el" href="classpvfmm_1_1Cheb__Node.html" title="Tree node class for volume data.">pvfmm::Cheb_Node</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00027">27</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="af9f207fd0e8c1f789a6fcae459f702e7" name="af9f207fd0e8c1f789a6fcae459f702e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f207fd0e8c1f789a6fcae459f702e7">&#9670;&#160;</a></span>ChebFMM_Tree</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">pvfmm::ChebFMM_Tree</a> = typedef FMM_Tree&lt;ChebFMM&lt;Real&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The octree class for volume FMM. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Tree.html" title="Base class for FMM tree.">pvfmm::FMM_Tree</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00039">39</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="a27b24a0eff6e33e7e9e8ddca8b830150" name="a27b24a0eff6e33e7e9e8ddca8b830150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27b24a0eff6e33e7e9e8ddca8b830150">&#9670;&#160;</a></span>ChebFn</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a27b24a0eff6e33e7e9e8ddca8b830150">pvfmm::ChebFn</a> = typedef typename ChebFMM_Node&lt;Real&gt;::Function_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluator function class for input volume density. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1Cheb__Node_1_1Function__t.html" title="Evaluator function class for input volume density.">pvfmm::Cheb_Node::Function_t</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00047">47</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="a4aabfd50558650e071450a3d1ccd87de" name="a4aabfd50558650e071450a3d1ccd87de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aabfd50558650e071450a3d1ccd87de">&#9670;&#160;</a></span>PtFMM</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a4aabfd50558650e071450a3d1ccd87de">pvfmm::PtFMM</a> = typedef FMM_Pts&lt;FMM_Node&lt;MPI_Node&lt;Real&gt; &gt;&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manages all the precomputed matrices and implements all the translation operations in FMM. An instance of PtFMM must be created and initialized with the kernel function to be used. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Pts.html" title="This class manages all the translation operators for particle FMM.">pvfmm::FMM_Pts</a>, <a class="el" href="classpvfmm_1_1FMM__Pts.html#a977f530f27bb7287512c4aebf193ab65" title="Initialize all the translation matrices (or load from file).">pvfmm::PtFMM::Initialize</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00199">199</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="a0b8999f6dc6e918bd4719de68bb6c854" name="a0b8999f6dc6e918bd4719de68bb6c854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8999f6dc6e918bd4719de68bb6c854">&#9670;&#160;</a></span>PtFMM_Data</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a0b8999f6dc6e918bd4719de68bb6c854">pvfmm::PtFMM_Data</a> = typedef typename PtFMM_Node&lt;Real&gt;::NodeData</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The data used to initialize the tree. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Node_1_1NodeData.html" title="Base class for node data. Contains initialization data for the node.">pvfmm::FMM_Node::NodeData</a>, <a class="el" href="classpvfmm_1_1MPI__Node_1_1NodeData.html" title="Base class for node data. Contains initialization data for the node.">pvfmm::MPI_Node::NodeData</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00220">220</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="a7cbab72b4909cbdef8c630c7a184a250" name="a7cbab72b4909cbdef8c630c7a184a250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cbab72b4909cbdef8c630c7a184a250">&#9670;&#160;</a></span>PtFMM_Node</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#a7cbab72b4909cbdef8c630c7a184a250">pvfmm::PtFMM_Node</a> = typedef FMM_Node&lt;MPI_Node&lt;Real&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The node data structure used in the tree. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Node.html" title="Base class for node of FMM_Node.">pvfmm::FMM_Node</a>, <a class="el" href="classpvfmm_1_1MPI__Node.html" title="Virtual base class for a locally essential tree node.">pvfmm::MPI_Node</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00213">213</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<a id="ab401e169be7784a6397fb0b09fa494f9" name="ab401e169be7784a6397fb0b09fa494f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab401e169be7784a6397fb0b09fa494f9">&#9670;&#160;</a></span>PtFMM_Tree</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">pvfmm::PtFMM_Tree</a> = typedef FMM_Tree&lt;PtFMM&lt;Real&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The FMM tree data structure. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classpvfmm_1_1FMM__Tree.html" title="Base class for FMM tree.">pvfmm::FMM_Tree</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pvfmm_8hpp_source.html#l00206">206</a> of file <a class="el" href="pvfmm_8hpp_source.html">pvfmm.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a33ee8fed824f0881ab2069d40cd3229b" name="a33ee8fed824f0881ab2069d40cd3229b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33ee8fed824f0881ab2069d40cd3229b">&#9670;&#160;</a></span>ChebFMM_Coeff2Nodes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::ChebFMM_Coeff2Nodes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ChebDeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate Chebyshev coefficients at tensor product Chebyshev nodes of first kind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">node_val</td><td>node_val function values at tensor product Chebyshev nodes.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ChebDeg</td><td>degree of Chebyshev polynomials.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof</td><td>number of scalar values at each node point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coeff</td><td>vector of Chebyshev coefficients. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac53014d99322385f17ada88d447f1b46" name="ac53014d99322385f17ada88d447f1b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53014d99322385f17ada88d447f1b46">&#9670;&#160;</a></span>ChebFMM_CreateTree() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">ChebFMM_Tree&lt; Real &gt; * pvfmm::ChebFMM_CreateTree </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cheb_deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>leaf_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>fn_coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BoundaryType&#160;</td>
          <td class="paramname"><em>bndry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a piecewise Chebyshev volume discretization in [0,1]^3. It first constructs a tree with the given leaf node coordinates and then adds the Chebyshev coefficient to each leaf node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cheb_deg</td><td>degree of the Chebyshev polynomials.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">leaf_coord</td><td>vector of points [x1 y1 z1 ... xn yn zn] where each point corresponds to a leaf node in the tree.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fn_coeff</td><td>vector of Chebyshev coefficients of size Nleaf*data_dim*(cheb_deg+1)(cheb_deg+2)(cheb_deg+3)/6, where Nleaf=leaf_coord.size()/3 is the number of leaf nodes.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trg_coord</td><td>target coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first target point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>MPI communicator.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bndry</td><td>type of boundary conditions (FreeSpace or Periodic)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the constructed tree. It must be destroyed using delete to free the resources. </dd></dl>

</div>
</div>
<a id="a9656032395eb05b25f714ff5faf95ff0" name="a9656032395eb05b25f714ff5faf95ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9656032395eb05b25f714ff5faf95ff0">&#9670;&#160;</a></span>ChebFMM_CreateTree() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">ChebFMM_Tree&lt; Real &gt; * pvfmm::ChebFMM_CreateTree </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cheb_deg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pvfmm_8hpp.html#a27b24a0eff6e33e7e9e8ddca8b830150">ChebFn</a>&lt; Real &gt;&#160;</td>
          <td class="paramname"><em>fn_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_pts</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BoundaryType&#160;</td>
          <td class="paramname"><em>bndry</em> = <code>FreeSpace</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>init_depth</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a piecewise Chebyshev volume discretization in [0,1]^3. It first constructs a uniform tree of depth init_depth and then adaptively refines each leaf node until the tails of the Chebyshev coefficients in each leaf node are smaller than tol and the number of target points in each leaf node are less than max_pts. It further refines the tree to satisfy the 2:1 balance constraint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cheb_deg</td><td>degree of the Chebyshev polynomials. The number of coefficients in each leaf node is data_dim*(cheb_deg+1)(cheb_deg+2)(cheb_deg+3)/6.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_dim</td><td>number of scalar values per point in the evaluation of the input function pointer (fn_ptr).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fn_ptr</td><td>input function pointer.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trg_coord</td><td>target coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first target point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>MPI communicator.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance for adaptive refinement.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_pts</td><td>maximum number of target points per leaf node.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bndry</td><td>type of boundary conditions (FreeSpace or Periodic)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_depth</td><td>depth of the initial tree before adaptive refinement. If zero then the depth is the minimum depth so that the number of leaf nodes is greater than the size of the MPI communicator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the constructed tree. It must be destroyed using delete to free the resources. </dd></dl>

</div>
</div>
<a id="a548c5e1908ecf244b3917c260709d623" name="a548c5e1908ecf244b3917c260709d623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a548c5e1908ecf244b3917c260709d623">&#9670;&#160;</a></span>ChebFMM_Evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::ChebFMM_Evaluate </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>loc_size</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run volume FMM and evaluate the result at the target points. </p>
<dl class="section note"><dt>Note</dt><dd>ChebFMM_Tree::SetupFMM(ChebFMM*) must be called before evaluating FMM for the first time with a tree, or when a tree has changed.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">trg_value</td><td>computed potential at the target points (in array-of-structure order).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tree</td><td>pointer to the Chebyshev tree.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">loc_size</td><td>local size of the output vector (used to partition it among the MPI ranks). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2f4cb2747769199fbb4eaab430deb72e" name="a2f4cb2747769199fbb4eaab430deb72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4cb2747769199fbb4eaab430deb72e">&#9670;&#160;</a></span>ChebFMM_GetLeafCoord()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::ChebFMM_GetLeafCoord </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>leaf_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the leaf node coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">leaf_coord</td><td>vector of points [x1 y1 z1 ... xn yn zn] where each point corresponds to a leaf node in the tree.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tree</td><td>pointer to the Chebyshev tree. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af0f3a3b47acd31665c82f784e56b0fa6" name="af0f3a3b47acd31665c82f784e56b0fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0f3a3b47acd31665c82f784e56b0fa6">&#9670;&#160;</a></span>ChebFMM_GetPotentialCoeff()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::ChebFMM_GetPotentialCoeff </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="pvfmm_8hpp.html#af9f207fd0e8c1f789a6fcae459f702e7">ChebFMM_Tree</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Chebyshev coefficients for the potential. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">coeff</td><td>vector of Chebyshev coefficients for the potential of size Nleaf*data_dim*(cheb_deg+1)(cheb_deg+2)(cheb_deg+3)/6, where Nleaf is the number of leaf nodes.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tree</td><td>pointer to the Chebyshev tree. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aae7f5c08f79057bc4c94f66d72f879d7" name="aae7f5c08f79057bc4c94f66d72f879d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7f5c08f79057bc4c94f66d72f879d7">&#9670;&#160;</a></span>ChebFMM_Nodes2Coeff()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::ChebFMM_Nodes2Coeff </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ChebDeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert function values on tensor product Chebyshev nodes (first kind nodes) to coefficients. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">coeff</td><td>vector of Chebyshev coefficients.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ChebDeg</td><td>degree of Chebyshev polynomials.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof</td><td>number of scalar values at each node point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node_val</td><td>function values at tensor product Chebyshev nodes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af48e77bdf4fdc7bea5f728540a956b79" name="af48e77bdf4fdc7bea5f728540a956b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48e77bdf4fdc7bea5f728540a956b79">&#9670;&#160;</a></span>PtFMM_CreateTree() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PtFMM_Tree&lt; Real &gt; * pvfmm::PtFMM_CreateTree </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>sl_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>sl_density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>dl_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>dl_density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_pts</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BoundaryType&#160;</td>
          <td class="paramname"><em>bndry</em> = <code>FreeSpace</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>init_depth</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new instance of the tree and return a pointer. The tree must eventually be be destroyed by calling delete. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sl_coord</td><td>single-layer source coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first source point. The coordinates must be in [0,1]^3.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sl_density</td><td>single-layer source density vector with values: [u1 v1 w1 ... un vn wn] where (u1 v1 w1) is the density vector for the first particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dl_coord</td><td>double-layer source coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first source point. The coordinates must be in [0,1]^3.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dl_density</td><td>double-layer source density vector with values: [u1 v1 w1 nx1 ny1 nz1 ... un vn wn nxn nyn nzn] where (u1 v1 w1) is the density vector for the first particle and (nx1 ny1 nz1) is the normal vector for the first particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trg_coord</td><td>target coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first target point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>MPI communicator.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_pts</td><td>maximum number of source points per octant.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bndry</td><td>boundary type (FreeSpace or Periodic)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_depth</td><td>minimum depth for any octant </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5eb8771a98533183cc4ba30a9fd71c0d" name="a5eb8771a98533183cc4ba30a9fd71c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb8771a98533183cc4ba30a9fd71c0d">&#9670;&#160;</a></span>PtFMM_CreateTree() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PtFMM_Tree&lt; Real &gt; * pvfmm::PtFMM_CreateTree </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>sl_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>sl_density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_pts</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BoundaryType&#160;</td>
          <td class="paramname"><em>bndry</em> = <code>FreeSpace</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>init_depth</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new instance of the tree and return a pointer. The tree must eventually be be destroyed by calling delete. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sl_coord</td><td>single-layer source coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first source point. The coordinates must be in [0,1]^3.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sl_density</td><td>single-layer source density vector with values: [u1 v1 w1 u2 ... un vn wn] where (u1 v1 w1) is the density vector for the first particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trg_coord</td><td>target coordinate vector with values: [x1 y1 z1 ... xn yn zn] where (x1 y1 z1) are the coordinates of the first target point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>MPI communicator.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_pts</td><td>maximum number of source points per octant.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bndry</td><td>boundary type (FreeSpace or Periodic)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_depth</td><td>minimum depth for any octant.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the constructed tree. </dd></dl>

</div>
</div>
<a id="aa1465ed63d3cc53525a2171c81b76d2a" name="aa1465ed63d3cc53525a2171c81b76d2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1465ed63d3cc53525a2171c81b76d2a">&#9670;&#160;</a></span>PtFMM_Evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Real &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pvfmm::PtFMM_Evaluate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="pvfmm_8hpp.html#ab401e169be7784a6397fb0b09fa494f9">PtFMM_Tree</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>trg_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>loc_size</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>sl_density</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>dl_density</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run FMM on the input octree and return the potential at the target points. The setup function PtFMM_Tree::SetupFMM(PtFMM_Tree* fmm_mat) must be called before evaluating FMM for the first time with a tree, or if a tree has changed. </p>
<dl class="section note"><dt>Note</dt><dd>pvfmm::PtFMM_Tree::SetupFMM(PtFMM*) must be called before evaluating FMM for the first time with a tree, or when a tree has changed.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tree</td><td>pointer to the octree.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">trg_val</td><td>target potential vector with values: [p1 q1 r1 ... pn qn rn] where (p1 q1 r1) is the potential at the first target point.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">loc_size</td><td>number of local target points.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sl_density</td><td>new single-layer source density vector.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dl_density</td><td>new double-layer source density vector. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
